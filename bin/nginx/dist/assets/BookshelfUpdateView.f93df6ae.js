import{d as y,j as r,n as D,o as s,c as l,f as x,a as t,b as n,v as c,y as B,F,p as U,z as V,w,l as M,k as P,m as v,t as S}from"./index.0ad1aa9b.js";const q=t("h1",null,"\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u0440\u0435\u0446\u0435\u043D\u0437\u0438\u044E",-1),j={key:0,class:"alert alert-danger",role:"alert"},A={class:"row p-3"},N={class:"mb-3 col-sm-12 col-md-6"},R=t("label",{class:"form-label"},"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u043A\u043D\u0438\u0433\u0438",-1),I={class:"mb-3 col-sm-12 col-md-6"},T=t("label",{class:"form-label"},"\u0410\u0432\u0442\u043E\u0440",-1),$={key:0,class:"mb-3 col-sm-12 col-md-6"},z=t("label",{class:"form-label"},"\u0424\u043E\u0442\u043E",-1),J={key:1,class:"mb-3 col-sm-12 col-md-6"},L=t("label",{class:"form-label"},"\u0424\u043E\u0442\u043E",-1),O=["required"],G={class:"mb-3 col-sm-12 col-md-6"},H=t("label",{class:"form-label"},"\u0420\u0435\u0439\u0442\u0438\u043D\u0433",-1),K=["value"],Q=t("div",{class:"form-text"},"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0430\u0448\u0443 \u043E\u0446\u0435\u043D\u043A\u0443 \u043E\u0442 1 \u0434\u043E 10, \u0433\u0434\u0435 10 - \u0445\u043E\u0440\u043E\u0448\u043E, \u0430 1 - \u043F\u043B\u043E\u0445\u043E.",-1),W={class:"mb-3"},X={class:"mb-3 form-check d-flex justify-content-end"},Y=t("label",{class:"form-label"},"\u041F\u0440\u043E\u0447\u0438\u0442\u0430\u043D\u043E",-1),eu=y({__name:"BookshelfUpdateView",setup(Z){const p=M(),m=P(),h=JSON.parse(localStorage.getItem("thisUser")).userdata,f=r(null),i=r(!1),d=r(!1);function _(){const a=[];for(let u=1;u<11;u++)a.push({name:u,value:u});return a}const e=r({title:"",description:"",author:"",rating:1,is_read:!1});function b(){i.value=!0,e.value.photo=""}function E(a){e.value.photo=a.target.files[0]||a.dataTransfer.files[0]}function k(){if(!e.value.title||!e.value.author||!e.value.photo&&i.value)d.value=!0,setInterval(()=>{d.value=!1},5e3);else{const a=`bookshelf/books/${p.params.id}/`,u=new FormData;u.append("title",e.value.title),u.append("description",e.value.description),u.append("author",e.value.author),e.value.photo&&u.append("photo",e.value.photo),u.append("rating",e.value.rating),u.append("is_read",e.value.is_read),v.patch(a,u).then(o=>{m.push({name:"bookshelf-detail",params:{id:o.data.id}})}).catch(o=>{alert(o)})}}function g(a){a.user_created.id!==h.id&&m.push({name:"page404"})}function C(){const a=`bookshelf/books/${p.params.id}`;v.get(a).then(u=>{g(u.data),e.value=u.data,delete e.value.photo}).catch(u=>{alert(u)})}return D(()=>{C()}),(a,u)=>(s(),l("div",null,[q,d.value?(s(),l("div",j,"\u041E\u0448\u0438\u0431\u043A\u0430! \u0417\u0430\u043F\u043E\u043B\u043D\u0438\u0442\u0435 \u0432\u0441\u0435 \u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u044B\u0435 \u043F\u043E\u043B\u044F!")):x("",!0),t("form",{class:"card",onSubmit:u[5]||(u[5]=w(()=>{},["prevent"]))},[t("div",A,[t("div",N,[R,n(t("input",{"onUpdate:modelValue":u[0]||(u[0]=o=>e.value.title=o),required:"",type:"text",class:"form-control"},null,512),[[c,e.value.title]])]),t("div",I,[T,n(t("input",{"onUpdate:modelValue":u[1]||(u[1]=o=>e.value.author=o),required:"",type:"text",class:"form-control"},null,512),[[c,e.value.author]])]),i.value?(s(),l("div",J,[L,t("input",{ref_key:"photo",ref:f,type:"file",required:i.value,class:"form-control",onChange:E},null,40,O)])):(s(),l("div",$,[z,t("button",{class:"form-control btn btn-primary",onClick:b},"\u0421\u043C\u0435\u043D\u0438\u0442\u044C \u0444\u043E\u0442\u043E")])),t("div",G,[H,n(t("select",{"onUpdate:modelValue":u[2]||(u[2]=o=>e.value.rating=o),class:"form-control"},[(s(!0),l(F,null,U(_(),o=>(s(),l("option",{key:o.name,value:o.value},S(o.name),9,K))),128))],512),[[B,e.value.rating]]),Q]),t("div",W,[n(t("textarea",{"onUpdate:modelValue":u[3]||(u[3]=o=>e.value.description=o),class:"form-control",cols:"30",rows:"10"},null,512),[[c,e.value.description]])]),t("div",X,[n(t("input",{"onUpdate:modelValue":u[4]||(u[4]=o=>e.value.is_read=o),type:"checkbox",class:"form-check-input"},null,512),[[V,e.value.is_read]]),Y]),t("div",{class:"d-flex justify-content-end"},[t("button",{type:"submit",class:"btn btn-primary",onClick:k},"\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u0440\u0435\u0446\u0435\u043D\u0437\u0438\u044E")])])],32)]))}});export{eu as default};
